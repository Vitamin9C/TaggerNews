{% extends "base.html" %}

{% block title %}TaggerNews - Top Stories{% endblock %}

{% block header_info %}
{% if db_oldest_date and db_newest_date %}
<p class="db-date-range">ðŸ“Š Data: {{ db_oldest_date.strftime('%b %d') }} - {{ db_newest_date.strftime('%b %d, %Y') }}
</p>
{% endif %}
{% endblock %}

{% block content %}
<div class="stories-header">
    <h2>Top Stories</h2>
    <span class="info-text" style="font-size:0.8rem;color:var(--text-muted);">Auto-refreshes via scheduler</span>
</div>

<div class="info-bar">
    <span>{{ total }} stories{% if active_period != 'all' %} ({{ active_period }}){% endif %}{% if active_tag %} tagged
        "{{ active_tag }}"{% endif %}</span>
</div>

<div id="story-list" class="story-list">
    {% for story in stories %}
    {% include "partials/story_card.html" %}
    {% endfor %}
</div>

{% if offset + stories|length < total %} <div
    hx-get="/stories/more?offset={{ offset + limit }}&limit={{ limit }}{% if active_tag %}&tag={{ active_tag | urlencode }}{% endif %}{% if active_period != 'all' %}&period={{ active_period | urlencode }}{% endif %}{% if date_from %}&from={{ date_from | urlencode }}{% endif %}{% if date_to %}&to={{ date_to | urlencode }}{% endif %}"
    hx-trigger="revealed" hx-swap="outerHTML" class="load-more">
    <span class="loading-text">Loading more stories...</span>
    </div>
    {% endif %}
    {% endblock %}